<!DOCTYPE html>
<html>
<head>
<script>

const remote = require('electron').remote;
const list = require('./list_components.js');
const xslt = require('./xslt.js');

const xmlOpt = '--xmlFile';
const xsltOpt = '--xsltFile';
const attrOpt = '--attribute';
const dbgOpt = '--debug';

var getOptions = function(args) {
  let options = {};
  for (let index = 1; index < args.length; index++) {
    keyPair = args[index].split('='); 
    if (keyPair.length == 2) {
      options[keyPair[0]] = keyPair[1];
    }
  }
  if (options[dbgOpt] == 'true') {
    for (let optionIndex in options){
      process.stderr.write("option: " + optionIndex + " = " + options[optionIndex] + "\n");
    }
  }
  return options;
};

var XSLTTranslation = function(options) {
  return xslt.performXSLTTranslationFilenames(options[xmlOpt], options[xsltOpt], options[attrOpt]);
};

var parseOptions= function() {
  let arguments = remote.getGlobal('sharedObject').prop1;
  let options = getOptions(arguments);
  if ((options[xmlOpt] == null) || (options[xsltOpt] == null))
  {
    process.stderr.write('I need at least an xmlFile and an xsltFile')
    window.close();
  }
  //list(options[xmlOpt])
  let result = XSLTTranslation(options);
  process.stderr.write(result);
  window.close();
};

</script>
</head>
<body onload="parseOptions()">
</body>
</html> 
